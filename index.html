<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í‚¤ ì…ë ¥í˜• ì´ë¯¸ì§€ ìƒì„±ê¸° (Imagen API)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 30px; background-color: #f4f7f6; }
        .container { max-width: 800px; margin: 0 auto; background-color: #ffffff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        h1 { color: #1e88e5; text-align: center; margin-bottom: 25px; }
        .input-group { margin-bottom: 15px; display: flex; align-items: center; }
        .input-group label { margin-right: 10px; font-weight: bold; width: 100px; }
        #api-key-input, #prompt-input { flex-grow: 1; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; }
        #prompt-input { margin-right: 10px; }
        #prompt-container { display: flex; align-items: center; }
        button { padding: 10px 15px; background-color: #1e88e5; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 15px; transition: background-color 0.3s; }
        button:hover { background-color: #1565c0; }
        #status-message { margin-top: 20px; font-size: 16px; color: #e53935; text-align: center; padding: 10px; border: 1px dashed #e53935; border-radius: 6px; }
        #security-warning { color: #ff9800; font-size: 14px; margin-top: 5px; text-align: center; }
        #image-container { margin-top: 30px; display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; }
        .generated-image { max-width: 100%; height: auto; border: 5px solid #e0e0e0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ Google AI ì´ë¯¸ì§€ ìƒì„±ê¸° (Gemini API)</h1>
        <p id="security-warning">âš ï¸ **ê²½ê³ :** ì´ í˜ì´ì§€ëŠ” í…ŒìŠ¤íŠ¸ìš©ì´ë©°, API í‚¤ê°€ í´ë¼ì´ì–¸íŠ¸ ë¸Œë¼ìš°ì €ì— ë…¸ì¶œë©ë‹ˆë‹¤. ì‹¤ì œ ì„œë¹„ìŠ¤ì— ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.</p>

        <div class="input-group">
            <label for="api-key-input">API Key:</label>
            <input type="password" id="api-key-input" placeholder="Google AI Studioì—ì„œ ë°œê¸‰ë°›ì€ í‚¤ ì…ë ¥" size="60">
        </div>

        <div id="prompt-container" class="input-group">
            <label for="prompt-input">ì„¤ëª… (Prompt):</label>
            <input type="text" id="prompt-input" placeholder="ìƒì„±í•  ì´ë¯¸ì§€ ì„¤ëª…ì„ ìì„¸í•˜ê²Œ ì…ë ¥í•˜ì„¸ìš”" required>
            <button onclick="generateImage()">ìƒì„± ì‹œì‘</button>
        </div>
        
        <p id="status-message">API í‚¤ë¥¼ ì…ë ¥í•˜ê³  ì„¤ëª…ì„ ì‘ì„±í•œ í›„ 'ìƒì„± ì‹œì‘' ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
        
        <div id="image-container">
            </div>
    </div>

    <script>
        const MODEL_NAME = "imagen-3.0-generate-002"; // Googleì˜ ìµœì‹  ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸

        async function generateImage() {
            const apiKey = document.getElementById('api-key-input').value.trim();
            const prompt = document.getElementById('prompt-input').value.trim();
            const statusMessage = document.getElementById('status-message');
            const imageContainer = document.getElementById('image-container');
            
            // í‚¤ ë° í”„ë¡¬í”„íŠ¸ ìœ íš¨ì„± ê²€ì‚¬
            if (!apiKey) {
                statusMessage.textContent = 'ğŸš¨ ì˜¤ë¥˜: API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!';
                statusMessage.style.color = '#e53935';
                return;
            }
            if (!prompt) {
                statusMessage.textContent = 'ì´ë¯¸ì§€ ì„¤ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                statusMessage.style.color = '#e53935';
                return;
            }

            // UI ì´ˆê¸°í™” ë° ë¡œë”© ìƒíƒœ í‘œì‹œ
            imageContainer.innerHTML = '';
            statusMessage.textContent = 'â³ ì´ë¯¸ì§€ë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.';
            statusMessage.style.color = '#ff9800';
            statusMessage.style.borderColor = '#ff9800';


            const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateImages?key=${apiKey}`;
            
            const payload = {
                requests: [{
                    prompt: prompt,
                    config: {
                        numberOfImages: 1, // ìƒì„±í•  ì´ë¯¸ì§€ ê°œìˆ˜
                        outputMimeType: 'image/png', // ì´ë¯¸ì§€ í˜•ì‹
                    }
                }]
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                });

                const data = await response.json();
                
                if (data.generatedImages && data.generatedImages.length > 0) {
                    statusMessage.textContent = 'âœ… ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ!';
                    statusMessage.style.color = '#4caf50';
                    statusMessage.style.borderColor = '#4caf50';
                    
                    data.generatedImages.forEach(img => {
                        const base64ImageBytes = img.image.imageBytes;
                        const imgElement = document.createElement('img');
                        
                        // Base64 ë°ì´í„°ë¥¼ ì´ë¯¸ì§€ ì†ŒìŠ¤ë¡œ ì„¤ì •
                        imgElement.src = `data:image/png;base64,${base64ImageBytes}`;
                        imgElement.classList.add('generated-image');
                        imgElement.alt = prompt;
                        
                        imageContainer.appendChild(imgElement);
                    });
                } else if (data.error) {
                    // API ì‘ë‹µì— ì˜¤ë¥˜ê°€ í¬í•¨ëœ ê²½ìš° (ì˜ˆ: 400 Bad Request, API Key Invalid ë“±)
                    statusMessage.textContent = `âŒ API ì˜¤ë¥˜ ë°œìƒ: ${data.error.message}`;
                    statusMessage.style.color = '#e53935';
                    statusMessage.style.borderColor = '#e53935';
                    console.error('API Error:', data.error);
                } else {
                     statusMessage.textContent = 'âŒ ì•Œ ìˆ˜ ì—†ëŠ” ìƒì„± ì˜¤ë¥˜ ë°œìƒ.';
                     statusMessage.style.color = '#e53935';
                     statusMessage.style.borderColor = '#e53935';
                }

            } catch (error) {
                // ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìì²´ì˜ ë¬¸ì œì¸ ê²½ìš° (ì˜ˆ: Failed to fetch, CORS ë¬¸ì œ)
                statusMessage.textContent = `âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë°œìƒ: Failed to fetch. (ì„œë²„/CORS/ì—°ê²° í™•ì¸ í•„ìš”)`;
                statusMessage.style.color = '#e53935';
                statusMessage.style.borderColor = '#e53935';
                console.error('Fetch Error:', error);
            }
        }
    </script>
</body>
</html>