<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>PPT 자동 생성기</title>

<!-- pptxgenjs -->
<script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

<style>
body {
  font-family: sans-serif;
  background: #0e0e11;
  color: #eee;
  padding: 20px;
}
textarea {
  width: 100%;
  height: 220px;
  background: #1a1a22;
  color: #fff;
  border: 1px solid #333;
  padding: 10px;
  font-size: 14px;
}
button {
  margin-top: 12px;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>
<body>

<h2>PPT 자동 생성기</h2>

<textarea id="input">
나무에 대하여
우리 주변에서 흔히 볼 수 있는 식물이며, 지구 생태계에 중요한 역할을 한다.

나무의 구조
나무는 목질부 조직으로 이루어져 있다.
뿌리, 줄기, 가지, 잎 등으로 구성된다.

나무의 역할
산소를 생성하고
생물의 서식지를 제공한다.
</textarea>

<br>
<button onclick="makePPT()">PPT 만들기</button>

<script>
function makePPT() {
  const text = document.getElementById("input").value.trim();
  const blocks = text.split(/\n\s*\n/); // 빈 줄 기준 분리

  let pptx = new PptxGenJS();
  pptx.defineLayout({ name:'CUSTOM', width:10, height:5.63 });
  pptx.layout = 'CUSTOM';

  blocks.forEach(block => {
    const lines = block.split("\n").map(v => v.trim()).filter(Boolean);
    if (lines.length < 2) return;

    const title = lines[0];
    const content = lines.slice(1).join("\n");

    let slide = pptx.addSlide();

    slide.addText(title, {
      x: 0.5,
      y: 0.4,
      w: 9,
      h: 1,
      fontSize: 28,
      bold: true
    });

    slide.addText(content, {
      x: 0.7,
      y: 1.5,
      w: 8.6,
      h: 3.5,
      fontSize: 16,
      lineSpacing: 24
    });
  });

  pptx.writeFile("자동_PPT.pptx");
}
</script>

</body>
</html>
